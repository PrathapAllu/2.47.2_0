function y(w,n={}){const b=n.timeoutMs||500,m=n.checkInterval||100,h=n.allowedPending||0,r={dom:1,network:1,layout:1,longtask:1,...n.weights||{}};let u=performance.now(),o=0,c=!1;function a(){u=performance.now()}let s;r.dom!==0&&(s=new MutationObserver(()=>a()),s.observe(document,{childList:!0,subtree:!0,attributes:!0,characterData:!0}));let i;if(r.layout!==0&&"PerformanceObserver"in window)try{i=new PerformanceObserver(e=>{for(const t of e.getEntries())t.hadRecentInput||a()}),i.observe({type:"layout-shift",buffered:!0})}catch{}let f;if(r.longtask!==0&&"PerformanceObserver"in window)try{f=new PerformanceObserver(e=>{e.getEntries().length>0&&a()}),f.observe({type:"longtask",buffered:!0})}catch{}let l;if(r.network!==0&&"PerformanceObserver"in window)try{l=new PerformanceObserver(e=>{for(const t of e.getEntries())t.initiatorType!=="xmlhttprequest"&&t.initiatorType!=="fetch"||(t.duration>0?o=Math.max(0,o-1):o++,a())}),l.observe({type:"resource",buffered:!0})}catch{}const v=setInterval(()=>{const e=performance.now()-u,t=Math.max(0,o-h);!c&&e>=b&&t===0&&(c=!0,d(),w())},m);function d(){s&&s.disconnect(),i&&i.disconnect(),f&&f.disconnect(),l&&l.disconnect(),clearInterval(v)}return function(){c||(c=!0),d()}}export{y as w};
