import{t as Oe,s as kt,v as Ct,dH as yn}from"./store-fcbe2a1f.js";import{a as Rt}from"./domCopyAnnotate-a2b92afc.js";import{D as De,P as Ke}from"./getTargetElementAttributes-3f1109f1.js";import{v as Ot}from"./v4-c70744d4.js";/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:Dt,setPrototypeOf:Lt,isFrozen:An,getPrototypeOf:_n,getOwnPropertyDescriptor:In}=Object;let{freeze:R,seal:U,create:Ut}=Object,{apply:Je,construct:Qe}=typeof Reflect<"u"&&Reflect;R||(R=function(n){return n}),U||(U=function(n){return n}),Je||(Je=function(n,t,r){return n.apply(t,r)}),Qe||(Qe=function(n,t){return new n(...t)});const Le=D(Array.prototype.forEach),Tn=D(Array.prototype.lastIndexOf),Pt=D(Array.prototype.pop),ye=D(Array.prototype.push),En=D(Array.prototype.splice),Ue=D(String.prototype.toLowerCase),Ze=D(String.prototype.toString),zt=D(String.prototype.match),Ae=D(String.prototype.replace),Sn=D(String.prototype.indexOf),xn=D(String.prototype.trim),q=D(Object.prototype.hasOwnProperty),O=D(RegExp.prototype.test),_e=wn(TypeError);function D(n){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return Je(n,t,a)}}function wn(n){return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Qe(n,r)}}function g(n,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ue;Lt&&Lt(n,null);let a=t.length;for(;a--;){let o=t[a];if(typeof o=="string"){const c=r(o);c!==o&&(An(t)||(t[a]=c),o=c)}n[o]=!0}return n}function Nn(n){for(let t=0;t<n.length;t++)q(n,t)||(n[t]=null);return n}function ae(n){const t=Ut(null);for(const[r,a]of Dt(n))q(n,r)&&(Array.isArray(a)?t[r]=Nn(a):a&&typeof a=="object"&&a.constructor===Object?t[r]=ae(a):t[r]=a);return t}function Ie(n,t){for(;n!==null;){const a=In(n,t);if(a){if(a.get)return D(a.get);if(typeof a.value=="function")return D(a.value)}n=_n(n)}function r(){return null}return r}const Ft=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),et=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),tt=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Mn=R(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nt=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),vn=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ht=R(["#text"]),qt=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),rt=R(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$t=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pe=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kn=U(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Cn=U(/<%[\w\W]*|[\w\W]*%>/gm),Rn=U(/\$\{[\w\W]*/gm),On=U(/^data-[\-\w.\u00B7-\uFFFF]+$/),Dn=U(/^aria-[\-\w]+$/),Gt=U(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ln=U(/^(?:\w+script|data):/i),Un=U(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Wt=U(/^html$/i),Pn=U(/^[a-z][.\w]*(-[.\w]+)+$/i);var jt=Object.freeze({__proto__:null,ARIA_ATTR:Dn,ATTR_WHITESPACE:Un,CUSTOM_ELEMENT:Pn,DATA_ATTR:On,DOCTYPE_NAME:Wt,ERB_EXPR:Cn,IS_ALLOWED_URI:Gt,IS_SCRIPT_OR_DATA:Ln,MUSTACHE_EXPR:kn,TMPLIT_EXPR:Rn});const Te={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},zn=function(){return typeof window>"u"?null:window},Fn=function(n,t){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let r=null;const a="data-tt-policy-suffix";t&&t.hasAttribute(a)&&(r=t.getAttribute(a));const o="dompurify"+(r?"#"+r:"");try{return n.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Bt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Yt(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zn();const t=e=>Yt(e);if(t.version="3.2.4",t.removed=[],!n||!n.document||n.document.nodeType!==Te.document||!n.Element)return t.isSupported=!1,t;let{document:r}=n;const a=r,o=a.currentScript,{DocumentFragment:c,HTMLTemplateElement:s,Node:f,Element:p,NodeFilter:i,NamedNodeMap:m=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:b}=n,I=p.prototype,F=Ie(I,"cloneNode"),Q=Ie(I,"remove"),Z=Ie(I,"nextSibling"),K=Ie(I,"childNodes"),W=Ie(I,"parentNode");if(typeof s=="function"){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let T,N="";const{implementation:S,createNodeIterator:H,createDocumentFragment:k,getElementsByTagName:J}=r,{importNode:Se}=a;let A=Bt();t.isSupported=typeof Dt=="function"&&typeof W=="function"&&S&&S.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:B,ERB_EXPR:ee,TMPLIT_EXPR:te,DATA_ATTR:fe,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:xe,ATTR_WHITESPACE:it,CUSTOM_ELEMENT:ln}=jt;let{IS_ALLOWED_URI:ct}=jt,x=null;const lt=g({},[...Ft,...et,...tt,...nt,...Ht]);let M=null;const st=g({},[...qt,...rt,...$t,...Pe]);let _=Object.seal(Ut(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),he=null,Fe=null,ut=!0,He=!0,mt=!1,dt=!0,oe=!1,qe=!0,ne=!1,$e=!1,Ge=!1,ie=!1,we=!1,Ne=!1,ft=!0,pt=!1;const sn="user-content-";let We=!0,ge=!1,ce={},le=null;const ht=g({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let gt=null;const bt=g({},["audio","video","img","source","image","track"]);let je=null;const yt=g({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Me="http://www.w3.org/1998/Math/MathML",ve="http://www.w3.org/2000/svg",Y="http://www.w3.org/1999/xhtml";let se=Y,Be=!1,Ye=null;const un=g({},[Me,ve,Y],Ze);let ke=g({},["mi","mo","mn","ms","mtext"]),Ce=g({},["annotation-xml"]);const mn=g({},["title","style","font","a","script"]);let be=null;const dn=["application/xhtml+xml","text/html"],fn="text/html";let w=null,ue=null;const pn=r.createElement("form"),At=function(e){return e instanceof RegExp||e instanceof Function},Xe=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ue&&ue===e)){if((!e||typeof e!="object")&&(e={}),e=ae(e),be=dn.indexOf(e.PARSER_MEDIA_TYPE)===-1?fn:e.PARSER_MEDIA_TYPE,w=be==="application/xhtml+xml"?Ze:Ue,x=q(e,"ALLOWED_TAGS")?g({},e.ALLOWED_TAGS,w):lt,M=q(e,"ALLOWED_ATTR")?g({},e.ALLOWED_ATTR,w):st,Ye=q(e,"ALLOWED_NAMESPACES")?g({},e.ALLOWED_NAMESPACES,Ze):un,je=q(e,"ADD_URI_SAFE_ATTR")?g(ae(yt),e.ADD_URI_SAFE_ATTR,w):yt,gt=q(e,"ADD_DATA_URI_TAGS")?g(ae(bt),e.ADD_DATA_URI_TAGS,w):bt,le=q(e,"FORBID_CONTENTS")?g({},e.FORBID_CONTENTS,w):ht,he=q(e,"FORBID_TAGS")?g({},e.FORBID_TAGS,w):{},Fe=q(e,"FORBID_ATTR")?g({},e.FORBID_ATTR,w):{},ce=q(e,"USE_PROFILES")?e.USE_PROFILES:!1,ut=e.ALLOW_ARIA_ATTR!==!1,He=e.ALLOW_DATA_ATTR!==!1,mt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,dt=e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,oe=e.SAFE_FOR_TEMPLATES||!1,qe=e.SAFE_FOR_XML!==!1,ne=e.WHOLE_DOCUMENT||!1,ie=e.RETURN_DOM||!1,we=e.RETURN_DOM_FRAGMENT||!1,Ne=e.RETURN_TRUSTED_TYPE||!1,Ge=e.FORCE_BODY||!1,ft=e.SANITIZE_DOM!==!1,pt=e.SANITIZE_NAMED_PROPS||!1,We=e.KEEP_CONTENT!==!1,ge=e.IN_PLACE||!1,ct=e.ALLOWED_URI_REGEXP||Gt,se=e.NAMESPACE||Y,ke=e.MATHML_TEXT_INTEGRATION_POINTS||ke,Ce=e.HTML_INTEGRATION_POINTS||Ce,_=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&At(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&At(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),oe&&(He=!1),we&&(ie=!0),ce&&(x=g({},Ht),M=[],ce.html===!0&&(g(x,Ft),g(M,qt)),ce.svg===!0&&(g(x,et),g(M,rt),g(M,Pe)),ce.svgFilters===!0&&(g(x,tt),g(M,rt),g(M,Pe)),ce.mathMl===!0&&(g(x,nt),g(M,$t),g(M,Pe))),e.ADD_TAGS&&(x===lt&&(x=ae(x)),g(x,e.ADD_TAGS,w)),e.ADD_ATTR&&(M===st&&(M=ae(M)),g(M,e.ADD_ATTR,w)),e.ADD_URI_SAFE_ATTR&&g(je,e.ADD_URI_SAFE_ATTR,w),e.FORBID_CONTENTS&&(le===ht&&(le=ae(le)),g(le,e.FORBID_CONTENTS,w)),We&&(x["#text"]=!0),ne&&g(x,["html","head","body"]),x.table&&(g(x,["tbody"]),delete he.tbody),e.TRUSTED_TYPES_POLICY){if(typeof e.TRUSTED_TYPES_POLICY.createHTML!="function")throw _e('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof e.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw _e('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');T=e.TRUSTED_TYPES_POLICY,N=T.createHTML("")}else T===void 0&&(T=Fn(b,o)),T!==null&&typeof N=="string"&&(N=T.createHTML(""));R&&R(e),ue=e}},_t=g({},[...et,...tt,...Mn]),It=g({},[...nt,...vn]),hn=function(e){let u=W(e);(!u||!u.tagName)&&(u={namespaceURI:se,tagName:"template"});const l=Ue(e.tagName),y=Ue(u.tagName);return Ye[e.namespaceURI]?e.namespaceURI===ve?u.namespaceURI===Y?l==="svg":u.namespaceURI===Me?l==="svg"&&(y==="annotation-xml"||ke[y]):!!_t[l]:e.namespaceURI===Me?u.namespaceURI===Y?l==="math":u.namespaceURI===ve?l==="math"&&Ce[y]:!!It[l]:e.namespaceURI===Y?u.namespaceURI===ve&&!Ce[y]||u.namespaceURI===Me&&!ke[y]?!1:!It[l]&&(mn[l]||!_t[l]):!!(be==="application/xhtml+xml"&&Ye[e.namespaceURI]):!1},re=function(e){ye(t.removed,{element:e});try{W(e).removeChild(e)}catch{Q(e)}},Re=function(e,u){try{ye(t.removed,{attribute:u.getAttributeNode(e),from:u})}catch{ye(t.removed,{attribute:null,from:u})}if(u.removeAttribute(e),e==="is")if(ie||we)try{re(u)}catch{}else try{u.setAttribute(e,"")}catch{}},Tt=function(e){let u=null,l=null;if(Ge)e="<remove></remove>"+e;else{const E=zt(e,/^[\r\n\t ]+/);l=E&&E[0]}be==="application/xhtml+xml"&&se===Y&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const y=T?T.createHTML(e):e;if(se===Y)try{u=new h().parseFromString(y,be)}catch{}if(!u||!u.documentElement){u=S.createDocument(se,"template",null);try{u.documentElement.innerHTML=Be?N:y}catch{}}const v=u.body||u.documentElement;return e&&l&&v.insertBefore(r.createTextNode(l),v.childNodes[0]||null),se===Y?J.call(u,ne?"html":"body")[0]:ne?u.documentElement:v},Et=function(e){return H.call(e.ownerDocument||e,e,i.SHOW_ELEMENT|i.SHOW_COMMENT|i.SHOW_TEXT|i.SHOW_PROCESSING_INSTRUCTION|i.SHOW_CDATA_SECTION,null)},Ve=function(e){return e instanceof d&&(typeof e.nodeName!="string"||typeof e.textContent!="string"||typeof e.removeChild!="function"||!(e.attributes instanceof m)||typeof e.removeAttribute!="function"||typeof e.setAttribute!="function"||typeof e.namespaceURI!="string"||typeof e.insertBefore!="function"||typeof e.hasChildNodes!="function")},St=function(e){return typeof f=="function"&&e instanceof f};function X(e,u,l){Le(e,y=>{y.call(t,u,l,ue)})}const xt=function(e){let u=null;if(X(A.beforeSanitizeElements,e,null),Ve(e))return re(e),!0;const l=w(e.nodeName);if(X(A.uponSanitizeElement,e,{tagName:l,allowedTags:x}),e.hasChildNodes()&&!St(e.firstElementChild)&&O(/<[/\w]/g,e.innerHTML)&&O(/<[/\w]/g,e.textContent)||e.nodeType===Te.progressingInstruction||qe&&e.nodeType===Te.comment&&O(/<[/\w]/g,e.data))return re(e),!0;if(!x[l]||he[l]){if(!he[l]&&Nt(l)&&(_.tagNameCheck instanceof RegExp&&O(_.tagNameCheck,l)||_.tagNameCheck instanceof Function&&_.tagNameCheck(l)))return!1;if(We&&!le[l]){const y=W(e)||e.parentNode,v=K(e)||e.childNodes;if(v&&y){const E=v.length;for(let V=E-1;V>=0;--V){const L=F(v[V],!0);L.__removalCount=(e.__removalCount||0)+1,y.insertBefore(L,Z(e))}}}return re(e),!0}return e instanceof p&&!hn(e)||(l==="noscript"||l==="noembed"||l==="noframes")&&O(/<\/no(script|embed|frames)/i,e.innerHTML)?(re(e),!0):(oe&&e.nodeType===Te.text&&(u=e.textContent,Le([B,ee,te],y=>{u=Ae(u,y," ")}),e.textContent!==u&&(ye(t.removed,{element:e.cloneNode()}),e.textContent=u)),X(A.afterSanitizeElements,e,null),!1)},wt=function(e,u,l){if(ft&&(u==="id"||u==="name")&&(l in r||l in pn))return!1;if(!(He&&!Fe[u]&&O(fe,u))&&!(ut&&O(pe,u))){if(!M[u]||Fe[u]){if(!(Nt(e)&&(_.tagNameCheck instanceof RegExp&&O(_.tagNameCheck,e)||_.tagNameCheck instanceof Function&&_.tagNameCheck(e))&&(_.attributeNameCheck instanceof RegExp&&O(_.attributeNameCheck,u)||_.attributeNameCheck instanceof Function&&_.attributeNameCheck(u))||u==="is"&&_.allowCustomizedBuiltInElements&&(_.tagNameCheck instanceof RegExp&&O(_.tagNameCheck,l)||_.tagNameCheck instanceof Function&&_.tagNameCheck(l))))return!1}else if(!je[u]&&!O(ct,Ae(l,it,""))&&!((u==="src"||u==="xlink:href"||u==="href")&&e!=="script"&&Sn(l,"data:")===0&&gt[e])&&!(mt&&!O(xe,Ae(l,it,"")))&&l)return!1}return!0},Nt=function(e){return e!=="annotation-xml"&&zt(e,ln)},Mt=function(e){X(A.beforeSanitizeAttributes,e,null);const{attributes:u}=e;if(!u||Ve(e))return;const l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M,forceKeepAttr:void 0};let y=u.length;for(;y--;){const v=u[y],{name:E,namespaceURI:V,value:L}=v,j=w(E);let C=E==="value"?L:xn(L);if(l.attrName=j,l.attrValue=C,l.keepAttr=!0,l.forceKeepAttr=void 0,X(A.uponSanitizeAttribute,e,l),C=l.attrValue,pt&&(j==="id"||j==="name")&&(Re(E,e),C=sn+C),qe&&O(/((--!?|])>)|<\/(style|title)/i,C)){Re(E,e);continue}if(l.forceKeepAttr||(Re(E,e),!l.keepAttr))continue;if(!dt&&O(/\/>/i,C)){Re(E,e);continue}oe&&Le([B,ee,te],bn=>{C=Ae(C,bn," ")});const vt=w(e.nodeName);if(wt(vt,j,C)){if(T&&typeof b=="object"&&typeof b.getAttributeType=="function"&&!V)switch(b.getAttributeType(vt,j)){case"TrustedHTML":{C=T.createHTML(C);break}case"TrustedScriptURL":{C=T.createScriptURL(C);break}}try{V?e.setAttributeNS(V,E,C):e.setAttribute(E,C),Ve(e)?re(e):Pt(t.removed)}catch{}}}X(A.afterSanitizeAttributes,e,null)},gn=function e(u){let l=null;const y=Et(u);for(X(A.beforeSanitizeShadowDOM,u,null);l=y.nextNode();)X(A.uponSanitizeShadowNode,l,null),xt(l),Mt(l),l.content instanceof c&&e(l.content);X(A.afterSanitizeShadowDOM,u,null)};return t.sanitize=function(e){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=null,y=null,v=null,E=null;if(Be=!e,Be&&(e="<!-->"),typeof e!="string"&&!St(e))if(typeof e.toString=="function"){if(e=e.toString(),typeof e!="string")throw _e("dirty is not a string, aborting")}else throw _e("toString is not a function");if(!t.isSupported)return e;if($e||Xe(u),t.removed=[],typeof e=="string"&&(ge=!1),ge){if(e.nodeName){const j=w(e.nodeName);if(!x[j]||he[j])throw _e("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof f)l=Tt("<!---->"),y=l.ownerDocument.importNode(e,!0),y.nodeType===Te.element&&y.nodeName==="BODY"||y.nodeName==="HTML"?l=y:l.appendChild(y);else{if(!ie&&!oe&&!ne&&e.indexOf("<")===-1)return T&&Ne?T.createHTML(e):e;if(l=Tt(e),!l)return ie?null:Ne?N:""}l&&Ge&&re(l.firstChild);const V=Et(ge?e:l);for(;v=V.nextNode();)xt(v),Mt(v),v.content instanceof c&&gn(v.content);if(ge)return e;if(ie){if(we)for(E=k.call(l.ownerDocument);l.firstChild;)E.appendChild(l.firstChild);else E=l;return(M.shadowroot||M.shadowrootmode)&&(E=Se.call(a,E,!0)),E}let L=ne?l.outerHTML:l.innerHTML;return ne&&x["!doctype"]&&l.ownerDocument&&l.ownerDocument.doctype&&l.ownerDocument.doctype.name&&O(Wt,l.ownerDocument.doctype.name)&&(L="<!DOCTYPE "+l.ownerDocument.doctype.name+`>
`+L),oe&&Le([B,ee,te],j=>{L=Ae(L,j," ")}),T&&Ne?T.createHTML(L):L},t.setConfig=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xe(e),$e=!0},t.clearConfig=function(){ue=null,$e=!1},t.isValidAttribute=function(e,u,l){ue||Xe({});const y=w(e),v=w(u);return wt(y,v,l)},t.addHook=function(e,u){typeof u=="function"&&ye(A[e],u)},t.removeHook=function(e,u){if(u!==void 0){const l=Tn(A[e],u);return l===-1?void 0:En(A[e],l,1)[0]}return Pt(A[e])},t.removeHooks=function(e){A[e]=[]},t.removeAllHooks=function(){A=Bt()},t}var Xt=Yt();const Hn=n=>{var r;if(n.getAttribute("data-ad-banner")==="true"||((r=n.getAttribute("title"))==null?void 0:r.toLowerCase())==="advertisement")return!1;const t=getComputedStyle(n);return!((t==null?void 0:t.display)==="none"||(t==null?void 0:t.visibility)==="hidden"||(t==null?void 0:t.opacity)==="0")},qn=.7,P={text:.4,attributes:.3,parentTag:.05,parentAttributes:.15,selector:.05,xpath:.05},me={prioritized:2,normal:1,deprioritized:.1},Vt=n=>{const t=n.match(/(\.ember-view|\.ember\d+|#ember\d+)/g);return!!t&&t.length>0},Kt=n=>{const t=Object.entries(n||{}).filter(([r])=>!De.includes(r));return!n||t.length===0?{multiplier:0,formattedAttributes:{}}:Object.entries(n).reduce(({multiplier:r,formattedAttributes:a},[o,c])=>De.includes(o)||Vt(c)?{multiplier:r+me.deprioritized,formattedAttributes:{...a,[o]:{value:c,multiplier:me.deprioritized}}}:Ke.includes(o)?{multiplier:r+me.prioritized,formattedAttributes:{...a,[o]:{value:c,multiplier:me.prioritized}}}:{multiplier:r+me.normal,formattedAttributes:{...a,[o]:{value:c,multiplier:me.normal}}},{multiplier:0,formattedAttributes:{}})},$n=n=>!(!n||Vt(n)),Gn=({attributes:n,selector:t,xpath:r,text:a,parentTag:o,parentAttributes:c})=>{let s=1;return $n(t)||(s-=P.selector),(!n||!Object.keys(n).length)&&(s-=P.attributes),(!a||!z(a))&&(s-=P.text),r||(s-=P.xpath),o||(s-=P.parentTag),(!c||!Object.keys(c).length)&&(s-=P.parentAttributes),Math.max(qn*s,.1)},Jt=({iframe:n,iframeAttributes:t})=>{if(!n||!t||Object.keys(t).length===0)return!1;const r=n.getAttribute("src");if(r&&r===t.src)return!0;const a=n.getAttribute("id");return!!(a&&a===t.id)},at=({doc:n,docParentIframe:t,tag:r,iframeAttributes:a,actionId:o})=>{var m;const c=Jt({iframe:t,iframeAttributes:a}),s=t?Hn(t):!0,f=(!a||a&&c)&&s;c&&!s&&Oe("iframe_match_not_traversable_guide_me",{actionId:o,iframeSrc:(t==null?void 0:t.getAttribute("src"))||"",iframeId:(t==null?void 0:t.getAttribute("id"))||""});const p=f?Array.from(n.querySelectorAll(r)).map(d=>({element:d,parentIframe:t})):[],i=n.querySelectorAll("iframe");for(let d=0;d<i.length;d+=1){const h=i[d];try{const b=h.contentDocument||((m=h.contentWindow)==null?void 0:m.document);if(b){const I=at({doc:b,docParentIframe:h,tag:r,iframeAttributes:a,actionId:o});p.push(...I)}}catch(b){console.warn(`Error accessing iframe content: ${b}`)}}return p},Wn=({wasInIframe:n,iframeAttributes:t,tag:r,actionId:a})=>t?at({doc:document,tag:r,iframeAttributes:t,actionId:a}):n===!1&&!t?Array.from(document.querySelectorAll(r)).map(o=>({element:o,parentIframe:null})):at({doc:document,tag:r,actionId:a}),jn=({attributes:n,selector:t,xpath:r,tag:a,text:o,aiFallbackElementId:c,wasInIframe:s,parentAttributes:f,parentTag:p,iframeAttributes:i,actionId:m})=>{var K,W,T;const d=[],h=Wn({wasInIframe:s,iframeAttributes:i,tag:a,actionId:m}),{multiplier:b,formattedAttributes:I}=Kt(n),{multiplier:F,formattedAttributes:Q}=Kt(f),Z=Gn({attributes:I,selector:t,xpath:r,text:o,parentTag:p,parentAttributes:Q});for(let N=0;N<h.length;N+=1){let S=0;const H=[],{element:k}=h[N];t&&(k.matches(t)||k.parentElement&&((K=k.parentElement)!=null&&K.matches(t)))&&(S+=P.selector,H.push("selector"));const J=$(k);if(o&&J&&(o===J||z(o)===z(J)||z(o,!1)===z(J,!1))&&(S+=P.text,H.push("text")),I){const A=Object.entries(I).reduce((B,[ee,{value:te,multiplier:fe}])=>{const pe=fe/b*P.attributes;return k.getAttribute(ee)===te?B+pe:B},0);S+=A,A>0&&H.push("attributes")}if(p&&p.toLowerCase()===((W=k.parentElement)==null?void 0:W.tagName.toLowerCase())&&(S+=P.parentTag,H.push("parentTag")),f&&k.parentElement){const A=Object.entries(Q).reduce((B,[ee,{value:te,multiplier:fe}])=>{var xe;const pe=fe/F*P.parentAttributes;return((xe=k.parentElement)==null?void 0:xe.getAttribute(ee))===te?B+pe:B},0);S+=A,A>0&&H.push("attributes")}const Se=de({xpath:r,doc:((T=h[N].parentIframe)==null?void 0:T.contentDocument)||void 0});Se&&Se===k&&(S+=P.xpath,H.push("xpath")),S>=Z&&d.push({element:k,score:S,matchMethods:H,parentIframe:h[N].parentIframe})}if(d.length){const N=d.sort((k,J)=>J.score-k.score),S=N[0],H=N.filter(k=>k.score===S.score);if(S&&H.length===1)return{element:S.element,matchMethod:S.matchMethods.join(", "),parentIframe:S.parentIframe}}if(c){const N=document.querySelector(`[_i_d="${c}"]`);if(N)return{element:N,matchMethod:"ai_fallback"}}return{element:null,matchMethod:null}},Ee=({doc:n,text:t,tag:r,selector:a,xpath:o,attributes:c,actionId:s,docParentIframe:f,wasInIframe:p,iframeAttributes:i,callback:m})=>{var F,Q;let d=[],h=null;const b=Jt({iframe:(F=n==null?void 0:n.defaultView)==null?void 0:F.frameElement,iframeAttributes:i});if((b||!i)&&(h=m({doc:n,text:t,tag:r,selector:a,xpath:o,attributes:c,actionId:s})),h&&d.push({element:h,parentIframe:f}),p===!1&&!i||b&&h)return d;const I=n.querySelectorAll("iframe");for(let Z=0;Z<I.length;Z+=1){const K=I[Z];try{const W=K.contentDocument||((Q=K.contentWindow)==null?void 0:Q.document);if(W){const T=Ee({doc:W,docParentIframe:K,text:t,tag:r,selector:a,xpath:o,attributes:c,actionId:s,wasInIframe:p,iframeAttributes:i,callback:m});if(d=[...d,...T],d.length>1)break}}catch{G("guide_me_iframe_access_error",{actionId:s})}}return d},Bn=({doc:n=document,selector:t,xpath:r,text:a})=>{if(!t)return null;const o=n.querySelectorAll(t);if((o==null?void 0:o.length)>1){if(a){const c=ze({text:a,doc:n}).find(s=>Array.prototype.includes.call(o,s));if(c)return c}if(r){const c=de({xpath:r,doc:n});if(Array.from(o).find(s=>s===c))return c}}return(o==null?void 0:o.length)===1?o[0]:null},Qt=({attributes:n,selector:t,xpath:r,tag:a,text:o,aiFallbackElementId:c,actionId:s,wasInIframe:f,iframeAttributes:p})=>{if(o&&z(o)){const i=Ee({doc:document,text:o,tag:a,selector:t,xpath:r,attributes:n,actionId:s,wasInIframe:f,iframeAttributes:p,callback:m=>cn({doc:m.doc,text:m.text,tag:m.tag})});if(i.length===1)return{...i[0],matchMethod:"text"}}if(n){const i=Ee({doc:document,text:o,tag:a,selector:t,xpath:r,attributes:n,actionId:s,wasInIframe:f,iframeAttributes:p,callback:m=>ot({doc:m.doc,attributes:m.attributes,actionId:m.actionId,tag:m.tag})});if(i.length===1)return{...i[0],matchMethod:"attributes"}}if(t){const i=Ee({doc:document,text:o,tag:a,selector:t,xpath:r,attributes:n,actionId:s,wasInIframe:f,iframeAttributes:p,callback:m=>Bn({doc:m.doc,selector:m.selector,text:m.text,xpath:m.xpath})});if(i.length===1)return{...i[0],matchMethod:"selector"}}if(r){const i=Ee({doc:document,text:o,tag:a,selector:t,xpath:r,attributes:n,actionId:s,wasInIframe:f,iframeAttributes:p,callback:m=>de({doc:m.doc,xpath:m.xpath})});if(i.length===1)return{...i[0],matchMethod:"xpath"}}if(c){const i=document.querySelector(`[_i_d="${c}"]`);if(i)return{element:i,matchMethod:"ai_fallback"}}return{element:null,matchMethod:null}},Yn=n=>{chrome.storage.local.set({liveAction:JSON.stringify(n)})},Xn=()=>{chrome.storage.local.remove("liveAction")},Vn=()=>new Promise(n=>{chrome.storage.local.get("liveAction",t=>{const r=t.liveAction?JSON.parse(t.liveAction):void 0;n(r)})}),Zt=n=>{chrome.storage.local.set({displayErrorToasts:n})},Kn=n=>{chrome.storage.local.get("isGuiding",t=>{chrome.storage.local.set({isGuiding:n.toString()}),t.isGuiding==="false"&&n===!0?chrome.storage.local.set({guideMeSessionId:Ot()}):t.isGuiding==="true"&&n===!1&&chrome.storage.local.set({guideMeSessionId:""})}),n||Zt([])},Jn=()=>new Promise(n=>{chrome.storage.local.get("isGuiding",t=>{const r=t.isGuiding==="true";n(r)})}),Qn=n=>{chrome.storage.local.set({canEdit:n.toString()})},Zn=()=>new Promise(n=>{chrome.storage.local.get("canEdit",t=>{const r=t.canEdit==="true";n(r)})}),en=()=>new Promise(n=>{chrome.storage.local.get("guideMeSessionId",t=>{n(t.guideMeSessionId)})}),$=n=>n instanceof HTMLElement?n.innerText||n.textContent||"":n.textContent||"",z=(n,t=!0)=>{if(!n||n.trim()==="")return"";let r=n.trim().toLowerCase();return t?[r]=r.split(`
`):r.replace(/\n/g," "),[r]=r.split("	"),r=r.replace(/[^a-z]/g,""),r},ze=({text:n,doc:t=document})=>{var r;return(r=Array.from(t.querySelectorAll("*")))==null?void 0:r.filter(a=>{var o;return(o=$(a))==null?void 0:o.includes(n)})},de=({xpath:n,doc:t=document})=>{var a;if(!t)return null;let r=null;return n&&(r=(a=t.evaluate(n,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null))==null?void 0:a.singleNodeValue),r},ot=({attributes:n,tag:t,actionId:r,doc:a=document})=>{if(!n)return null;const o=Object.entries(n).reduce((f,[p,i])=>`${f}[${CSS.escape(p)}="${CSS.escape(i)}"]`,""),c=a.querySelectorAll(`${t}${o}`);if(c.length===1)return c[0];if(c.length!==1){const[f,p]=Object.entries(n).reduce(([i,m],[d,h])=>{const b=De.includes(d)?i:`${i}[${CSS.escape(d)}="${CSS.escape(h)}"]`,I=Ke.includes(d)?`${m}[${CSS.escape(d)}="${CSS.escape(h)}"]`:m;return[b,I]},["",""]);if(f){const i=a.querySelectorAll(`${t}${f}`);if(i.length===1)return i[0]}if(p){const i=a.querySelectorAll(`${t}${p}`);if(i.length===1)return i[0]}}const{guideMeIndividualAttrMatch:s}=Ct(kt.getState());return s?dr({attributes:n,tag:t,actionId:r,doc:a}):null},tn=(n,t=document)=>{var a,o;const r=Array.from(t.querySelectorAll("iframe"));for(let c=0;c<r.length;c+=1){const s=r[c];if(((a=s.contentDocument)==null?void 0:a.querySelector(n))!==null)return s;const f=s.contentDocument||((o=s.contentWindow)==null?void 0:o.document);if(f)return tn(n,f)}return null},nn=({selector:n,xpath:t,text:r})=>{var s;const a=tn(n),o=(s=a==null?void 0:a.contentDocument)==null?void 0:s.querySelectorAll(n),c=(o==null?void 0:o.length)&&o||document.querySelectorAll(n);if((c==null?void 0:c.length)>1){if(r){const f=ze({text:r}).find(p=>Array.prototype.includes.call(c,p));if(f)return{element:f,parentIframe:a,matchedIframeChildren:o}}if(t){const f=de({xpath:t});if(Array.from(c).find(p=>p===f))return{element:f,parentIframe:a,matchedIframeChildren:o}}}return{element:c.length===1?c[0]:null,parentIframe:a,matchedIframeChildren:o}},rn=["a","button","details","summary",'[role="button"]','[role="link"]','[role="menuitem"]','[role="treeitem"]'],er=["input","textarea","select","option","label",'[tabindex]:not([tabindex="-1"])',"[contenteditable]",'[role="option"]'],an=[...rn,...er],on=n=>{const t=n.matches(an.join(", ")),r=n instanceof HTMLElement?n.hasAttribute("tabindex"):!1,a=n.hasAttribute("onclick")||n.hasAttribute("onkeydown")||n.hasAttribute("onkeypress")||n.hasAttribute("onkeyup"),o=window.getComputedStyle(n).cursor==="pointer",c=getComputedStyle(n),s=n.getBoundingClientRect();return c.display==="none"||c.visibility==="hidden"||c.opacity==="0"||s.width===0&&s.height===0?!1:t||a||o||r},tr=(n=document)=>Array.from(n.querySelectorAll("*")).filter(t=>on(t)),cn=({doc:n=document,text:t,tag:r})=>{const a=z(t);if(!a)return null;const o=n.querySelectorAll(r),c=[];if(o.forEach(i=>{z($(i))===a&&c.push(i)}),c.length===1)return c[0];if(c.length>1){const i=[];if(c.forEach(m=>{$(m)===t&&i.push(m)}),i.length===1)return i[0]}const s=tr(n).filter(i=>z($(i)||"").includes(a));if(s.length===1)return s[0];if(s.length>1){const i=[];if(s.forEach(m=>{$(m)===t&&i.push(m)}),i.length===1)return i[0]}const f=ze({doc:n,text:a}),p=ze({doc:n,text:t});if(f.length===1)return f[0];if(f.length>1){const i=[];if(p.forEach(m=>{$(m)===t&&i.push(m)}),i.length===1)return i[0]}return null},nr=(n,t,r,a,o,c,s)=>{const f=cn({tag:t,text:n});if(f)return{element:f,matchMethod:"text"};const p=ot({attributes:o,tag:t,actionId:c});if(p)return{element:p,matchMethod:"attributes"};const i=z(n);if(r){const{element:d,parentIframe:h,matchedIframeChildren:b}=nn({selector:r,xpath:a,text:n});if(d&&(z($(d)??"")===i||$(d)===n))return{element:d,matchMethod:"selector",parentIframe:h,matchedIframeChildren:b}}const m=de({xpath:a});if(m&&(z($(m)??"")===i||$(m)===n))return{element:m,matchMethod:"xpath"};if(s){const d=document.querySelector(`[_i_d="${s}"]`);if(d)return{element:d,matchMethod:"ai_fallback"}}return{element:null,matchMethod:null}},rr=({attributes:n,selector:t,xpath:r,tag:a,text:o,aiFallbackElementId:c,actionId:s})=>{if(o)return nr(o,a,t,r,n,s,c);if(!o){const f=ot({attributes:n,tag:a,actionId:s});if(f)return{element:f,matchMethod:"attributes"};if(t){const{element:i,parentIframe:m,matchedIframeChildren:d}=nn({selector:t,xpath:r,text:o});if(i)return{element:i,matchMethod:"selector",parentIframe:m,matchedIframeChildren:d}}const p=de({xpath:r});if(p)return{element:p,matchMethod:"xpath"};if(c){const i=document.querySelector(`[_i_d="${c}"]`);if(i)return{element:i,matchMethod:"ai_fallback"}}}return{element:null,matchMethod:null}},ar=({selector:n,attributes:t,xpath:r,tag:a,text:o,algoVersion:c,algoV3Enabled:s,isAiFallbackEnabled:f,isAiFallbackAlwaysOnEnabled:p,aiFallbackElementId:i,actionId:m,wasInIframe:d,iframeAttributes:h,parentAttributes:b,parentTag:I})=>{if(f&&p)return i?{element:document.querySelector(`[_i_d="${i}"]`),matchMethod:"ai_fallback",algorithm:"ai_fallback"}:{element:null,matchMethod:null,algorithm:"ai_fallback"};if(c==="v4"){const F=jn({selector:n,xpath:r,tag:a,text:o,attributes:t,parentAttributes:b,parentTag:I,aiFallbackElementId:i,wasInIframe:d,iframeAttributes:h,actionId:m});return F.element?{...F,algorithm:"v4"}:{...Qt({selector:n,xpath:r,tag:a,text:o,attributes:t,aiFallbackElementId:i,actionId:m,wasInIframe:d,iframeAttributes:h}),algorithm:"v3"}}return s?{...Qt({selector:n,xpath:r,tag:a,text:o,attributes:t,aiFallbackElementId:i,actionId:m,wasInIframe:d,iframeAttributes:h}),algorithm:"v3"}:{...rr({selector:n,xpath:r,tag:a,text:o,attributes:t,aiFallbackElementId:i,actionId:m}),algorithm:"text matching"}},or=n=>{chrome.storage.local.set({liveActionMatches:n})},ir=()=>new Promise(n=>{chrome.storage.local.get("liveActionMatches",t=>{const r=t.liveActionMatches?t.liveActionMatches:[];n(r)})}),G=(n,t)=>{en().then(r=>{Oe(n,{...t,sessionId:r})}).catch(()=>{Oe(n,t)})},cr=async({actionId:n,matchMethod:t,url:r,algorithm:a})=>{const o=await ir()||[];o.find(c=>c.actionId===n)||(G("matching_algorithm_guide_me",{actionId:n,matchMethod:t,algorithm:a}),or([...o,{actionId:n,method:t,url:r}]))},lr=()=>new Promise(n=>{chrome.storage.local.get("displayErrorToasts",t=>{const r=t.displayErrorToasts?t.displayErrorToasts:[];n(r)})}),sr=async({api:n,scribeId:t,actionId:r})=>{const a={name:`${Ot()}.html`,is_scribe_live:!0,scribe_live_scribe_id:t,scribe_live_action_id:r};try{const o=await n.post("/signed_urls/",a),{upload_url:c,download_url:s}=o.data;return{uploadUrl:c,downloadUrl:s}}catch(o){return console.error("Error fetching signed URL:",o),{uploadUrl:"",downloadUrl:""}}},ur=async({documentId:n,actionId:t,domString:r,uploadUrl:a})=>{try{await yn({method:"PUT",url:a,data:r,headers:{"Content-Type":"text/html"},timeout:6e4}),G("guide_me_s3_dom_upload_success",{documentId:n,actionId:t})}catch(o){console.error("Error uploading DOM to S3:",o),G("guide_me_s3_dom_upload_error",{documentId:n,actionId:t,error:o})}},mr=async({api:n,documentId:t,actionId:r,type:a,domString:o,trackingDetails:c})=>{if(!r)return;const s=await lr()||[],f=s.find(h=>h.actionId===r),p=kt.getState(),{guideMeSaveDom:i,domUpload:m}=Ct(p);let d="different_page_fallback_guide_me";if(a==="selector_not_found"?d="refer_to_screenshot_fallback_guide_me":a==="selector_found"&&(d="click_target_displayed_guide_me"),!f&&i&&o&&m){const{uploadUrl:h,downloadUrl:b}=await sr({api:n,scribeId:t,actionId:r});h&&await ur({documentId:t,actionId:r,domString:o,uploadUrl:h}),G(d,{documentId:t,actionId:r,type:a,s3Url:b,...c}),Zt([...s,{actionId:r}]);return}G(d,{documentId:t,actionId:r,type:a,...c})},dr=({attributes:n,tag:t,actionId:r,doc:a=document})=>{const[o,c]=Object.entries(n).reduce(([i,m],[d,h])=>{const b=CSS.escape(h),I=De.includes(d),F=Ke.includes(d);return[I?i:{...i,[d]:b},F?{...m,[d]:b}:m]},[{},{}]);if(c!=null&&c.name){const i=a.getElementsByName(c.name);if(G("matching_algorithm_guide_me",{actionId:r,matchMethod:"attr-name"}),i.length===1)return i[0]}const s=new Set;for(const[i,m]of Object.entries(c)){const d=`${t}[${CSS.escape(i)}="${CSS.escape(m)}"]`,h=a.querySelectorAll(d);for(const b of h)s.add(b)}if(s.size===1)return G("matching_algorithm_guide_me",{actionId:r,matchMethod:"attr-prioritized"}),[...s][0];const f=new Set;for(const[i,m]of Object.entries(o)){const d=`${t}[${CSS.escape(i)}="${CSS.escape(m)}"]`,h=a.querySelectorAll(d);for(const b of h)f.add(b)}if(f.size===1)return G("matching_algorithm_guide_me",{actionId:r,matchMethod:"attr-deprioritized"}),[...f][0];const p=new Set;for(const[i,m]of Object.entries(n)){const d=`${t}[${CSS.escape(i)}="${CSS.escape(m)}"]`,h=a.querySelectorAll(d);for(const b of h)p.add(b)}return p.size===1?(G("matching_algorithm_guide_me",{actionId:r,matchMethod:"attr-any"}),[...p][0]):null},fr=()=>{const n=(r,a)=>{var c,s;const o=r.querySelectorAll("iframe");for(let f=o.length-1;f>=0;f-=1)try{const p=o[f],i=p.contentDocument||((c=p.contentWindow)==null?void 0:c.document),m=a.querySelectorAll("iframe")[f];if(i&&i.body){const d=Rt(i==null?void 0:i.body);n(i,d);const h=r.createElement("div");h.setAttribute("scribe-data-replaced-iframe-src",p.src);const b=(s=i==null?void 0:i.body)==null?void 0:s.innerHTML;b&&(h.innerHTML=Xt.sanitize(b)),m.replaceWith(h)}}catch{const p=a.querySelectorAll("iframe")[f];p&&p.setAttribute("scribe-data-error","Could not inline iframe content")}},t=Rt(document==null?void 0:document.body);return n(document,t),t.outerHTML};function pr(){var t;const n="*://*/*";chrome.runtime.sendMessage({messageType:"update-live-index",data:{url:n}}),(t=chrome==null?void 0:chrome.tabs)!=null&&t.query?chrome.tabs.query({url:n,active:!0},function(r){r&&r[0]&&r[0].id&&chrome.tabs.sendMessage(r[0].id,{messageType:"advanceLiveStep"})}):chrome.runtime.sendMessage({messageType:"advanceLiveStep"})}function hr({showMessage:n,message:t,dom:r,url:a,sessionId:o,requestId:c}){chrome.runtime.sendMessage({messageType:"setGuideMeStepNotFound",data:{showMessage:n,message:t,dom:r,url:a,sessionId:o,requestId:c}})}function gr(n,t,r){chrome.runtime.lastError||n.post("/ghostwriter/suggest_selector/",{current_dom:r,action:t}).then(a=>{if(a.status&&a.status>=200&&a.status<300){const{target_selector:o}=a.data,c=`*://${t.domain}/*`;chrome.tabs.query({url:c,active:!0},function(s){s&&s[0]&&s[0].id&&chrome.tabs.sendMessage(s[0].id,{messageType:"highlightTargetGhostwriter",targetSelector:o,debugGhostwriter:!0,action:t})})}else Oe("error_guide_me",{location:"extension",response:a})})}export{rn as I,an as a,G as b,fr as c,Vn as d,Zn as e,ar as f,Jn as g,Kn as h,on as i,Xn as j,pr as k,mr as l,gr as m,Yn as n,en as o,Xt as p,Qn as q,hr as s,cr as t};
