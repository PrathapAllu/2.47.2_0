import{$ as k,b as x,c as G,_ as T,a as P}from"./index-971785a2.js";import{R as d,r as o}from"./index-8b3efc3f.js";import{$ as J,e as N,a as I}from"./Label-43f6936b.js";import{$ as Q}from"./index-e669e871.js";function L(e){const r=e+"CollectionProvider",[u,s]=k(r),[F,v]=u(r,{collectionRef:{current:null},itemMap:new Map}),C=f=>{const{scope:t,children:c}=f,n=d.useRef(null),a=d.useRef(new Map).current;return d.createElement(F,{scope:t,itemMap:a,collectionRef:n},c)},A=e+"CollectionSlot",m=d.forwardRef((f,t)=>{const{scope:c,children:n}=f,a=v(A,c),p=x(t,a.collectionRef);return d.createElement(G,{ref:p},n)}),l=e+"CollectionItemSlot",w="data-radix-collection-item",R=d.forwardRef((f,t)=>{const{scope:c,children:n,...a}=f,p=d.useRef(null),S=x(t,p),E=v(l,c);return d.useEffect(()=>(E.itemMap.set(p,{ref:p,...a}),()=>void E.itemMap.delete(p))),d.createElement(G,{[w]:"",ref:S},n)});function g(f){const t=v(e+"CollectionConsumer",f);return d.useCallback(()=>{const c=t.collectionRef.current;if(!c)return[];const n=Array.from(c.querySelectorAll(`[${w}]`));return Array.from(t.itemMap.values()).sort((a,p)=>n.indexOf(a.ref.current)-n.indexOf(p.ref.current))},[t.collectionRef,t.itemMap])}return[{Provider:C,Slot:m,ItemSlot:R},g,s]}const V=o.createContext(void 0);function B(e){const r=o.useContext(V);return e||r||"ltr"}const y="rovingFocusGroup.onEntryFocus",W={bubbles:!1,cancelable:!0},M="RovingFocusGroup",[D,K,X]=L(M),[Y,Z]=k(M,[X]),[ee,te]=Y(M),oe=o.forwardRef((e,r)=>o.createElement(D.Provider,{scope:e.__scopeRovingFocusGroup},o.createElement(D.Slot,{scope:e.__scopeRovingFocusGroup},o.createElement(re,T({},e,{ref:r}))))),re=o.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:u,orientation:s,loop:F=!1,dir:v,currentTabStopId:C,defaultCurrentTabStopId:A,onCurrentTabStopIdChange:m,onEntryFocus:l,...w}=e,R=o.useRef(null),g=x(r,R),f=B(v),[t=null,c]=J({prop:C,defaultProp:A,onChange:m}),[n,a]=o.useState(!1),p=N(l),S=K(u),E=o.useRef(!1),[U,_]=o.useState(0);return o.useEffect(()=>{const i=R.current;if(i)return i.addEventListener(y,p),()=>i.removeEventListener(y,p)},[p]),o.createElement(ee,{scope:u,orientation:s,dir:f,loop:F,currentTabStopId:t,onItemFocus:o.useCallback(i=>c(i),[c]),onItemShiftTab:o.useCallback(()=>a(!0),[]),onFocusableItemAdd:o.useCallback(()=>_(i=>i+1),[]),onFocusableItemRemove:o.useCallback(()=>_(i=>i-1),[])},o.createElement(P.div,T({tabIndex:n||U===0?-1:0,"data-orientation":s},w,{ref:g,style:{outline:"none",...e.style},onMouseDown:I(e.onMouseDown,()=>{E.current=!0}),onFocus:I(e.onFocus,i=>{const q=!E.current;if(i.target===i.currentTarget&&q&&!n){const $=new CustomEvent(y,W);if(i.currentTarget.dispatchEvent($),!$.defaultPrevented){const h=S().filter(b=>b.focusable),z=h.find(b=>b.active),H=h.find(b=>b.id===t),j=[z,H,...h].filter(Boolean).map(b=>b.ref.current);O(j)}}E.current=!1}),onBlur:I(e.onBlur,()=>a(!1))})))}),ne="RovingFocusGroupItem",ce=o.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:u,focusable:s=!0,active:F=!1,tabStopId:v,...C}=e,A=Q(),m=v||A,l=te(ne,u),w=l.currentTabStopId===m,R=K(u),{onFocusableItemAdd:g,onFocusableItemRemove:f}=l;return o.useEffect(()=>{if(s)return g(),()=>f()},[s,g,f]),o.createElement(D.ItemSlot,{scope:u,id:m,focusable:s,active:F},o.createElement(P.span,T({tabIndex:w?0:-1,"data-orientation":l.orientation},C,{ref:r,onMouseDown:I(e.onMouseDown,t=>{s?l.onItemFocus(m):t.preventDefault()}),onFocus:I(e.onFocus,()=>l.onItemFocus(m)),onKeyDown:I(e.onKeyDown,t=>{if(t.key==="Tab"&&t.shiftKey){l.onItemShiftTab();return}if(t.target!==t.currentTarget)return;const c=ue(t,l.orientation,l.dir);if(c!==void 0){t.preventDefault();let n=R().filter(a=>a.focusable).map(a=>a.ref.current);if(c==="last")n.reverse();else if(c==="prev"||c==="next"){c==="prev"&&n.reverse();const a=n.indexOf(t.currentTarget);n=l.loop?le(n,a+1):n.slice(a+1)}setTimeout(()=>O(n))}})})))}),ae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function se(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ue(e,r,u){const s=se(e.key,u);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return ae[s]}function O(e){const r=document.activeElement;for(const u of e)if(u===r||(u.focus(),document.activeElement!==r))return}function le(e,r){return e.map((u,s)=>e[(r+s)%e.length])}const ie=oe,fe=ce;export{Z as $,B as a,ie as b,fe as c,L as d};
